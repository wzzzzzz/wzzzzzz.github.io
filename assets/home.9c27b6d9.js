import{d as M,r as C,o as N,c as n,F as x,a as T,u as S,b as w,t as f,e as o,n as _,f as O,g as $}from"./index.0b17e82f.js";const R=[{name:"Sheet1",rows:{0:{cells:{0:{text:"row",style:{patternType:"none"}},1:{text:"column1",style:{patternType:"none"}},2:{text:"column2",style:{patternType:"none"}},3:{text:"column3",style:{patternType:"none"}},4:{text:"column4",style:{patternType:"none"}}}},1:{cells:{0:{text:"100",style:{patternType:"none"}},1:{text:"1.png\uFF0CSheet-1,\u4E2D\u6587\u6587\u672C\uFF0C1234567890",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}},merge:[0,1]},3:{text:"2.png\uFF0Csheet-2,\u7B2C\u4E00\u884C\u7B2C\u4E09\u5217",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}}},4:{text:"3.jpg\uFF0C,,\u53F3\u4E0A\u89D2\uFF0C\u5DE6\u4E0B\u89D2",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}}}}},2:{cells:{0:{text:"200",style:{patternType:"none"},merge:[1,0]},1:{text:"4.jpg,,\u7EFF\u8272,\u6D4B\u8BD5,\u6D4B\u8BD52,\u6D4B\u8BD534",style:{patternType:"none"}},2:{text:"5.jpg,\u5168\u662F\u6C49\u5B57,333,\u4E2D\u6587\u6D4B\u8BD5",style:{patternType:"none"}},3:{text:"a.jpg,,\u6CA1\u6709\u82F1\u8BED,,,\u54C8\u54C8\u54C82345",style:{patternType:"none"},merge:[1,1]}}},3:{cells:{1:{text:"b1.jpg,sheet3,444",style:{patternType:"none"},merge:[0,1]}}},4:{cells:{0:{text:"300",style:{patternType:"none"},merge:[2,0]},1:{text:"pink,,,,\u54C8\u54C8\u54C8666,\u4E2D\u6587",style:{patternType:"none"},merge:[2,2]},4:{text:"6.jpg,,,,,\u518D\u6765\u4E00\u4E2A\u6D4B\u8BD5000,\u4E2D\u6587",style:{patternType:"none"}}}},5:{cells:{4:{text:"#ffff11,,#ffff11,\u563F\u563F\u563F\u{1F604}",style:{patternType:"none"},merge:[1,0]}}},6:{cells:{}}},merges:["E6:E7","B4:C4","A3:A4","D3:E4","B2:C2","A5:A7","B5:D7"]},{name:"Sheet-1",rows:{0:{cells:{0:{text:"t",style:{patternType:"none"}}}}},merges:[]},{name:"sheet-2",rows:{0:{cells:{0:{text:"22",style:{patternType:"none"}}}}},merges:[]}],U=[{name:"Sheet1",rows:{0:{cells:{0:{text:"row",style:{patternType:"none"}},1:{text:"column1",style:{patternType:"none"}},2:{text:"column2",style:{patternType:"none"}},3:{text:"column3",style:{patternType:"none"}},4:{text:"column4",style:{patternType:"none"}}}},1:{cells:{0:{text:"1",style:{patternType:"none"}},1:{text:"english1,qqqq",style:{patternType:"none"},merge:[0,1]},3:{text:"hhhhh",style:{patternType:"none"}},4:{text:",rightTop,leftBottom",style:{patternType:"none"}}}},2:{cells:{0:{text:"2",style:{patternType:"none"},merge:[1,0]},1:{text:"green,test12,test23,test34",style:{patternType:"none"}},2:{text:"GGG,333,nochinese",style:{patternType:"none"}},3:{text:"pink,,,hhhhhhh2345",style:{patternType:"none"},merge:[1,1]}}},3:{cells:{1:{text:"444",style:{patternType:"none"},merge:[0,1]}}},4:{cells:{0:{text:"3",style:{patternType:"none"},merge:[2,0]},1:{text:",,test666,QWER",style:{patternType:"none"},merge:[2,2]},4:{text:",,,test000,position",style:{patternType:"none"}}}},5:{cells:{4:{text:"#ffff11,face\u{1F604}",style:{patternType:"none"},merge:[1,0]}}},6:{cells:{}}},merges:["E6:E7","B4:C4","A3:A4","D3:E4","B2:C2","A5:A7","B5:D7"]},{name:"Sheet-1",rows:{0:{cells:{0:{text:"t",style:{patternType:"none"}}}}},merges:[]},{name:"sheet-2",rows:{0:{cells:{0:{text:"22",style:{patternType:"none"}}}}},merges:[]}],q=async()=>{var m,i;let c=R,s=U;const r=c==null?void 0:c[0].rows,u=s==null?void 0:s[0].rows,l=Object.values(r),h=Object.values(u);console.log(l);let y=[];for(let t=1;t<l.length;t++){let e=[],a;l[t].cells[0]?(e=[],y.push({height:Number(l[t].cells[0].text),rowCount:1,content:e})):(a=y[y.length-1],a.rowCount++,e=a.content);const g=l[t].cells,B=h[t].cells;for(const[d,p]of Object.entries(g)){if(d==="0")continue;const k=a?a.rowCount:1,E=p.text.split(/,|，/),I=(i=(m=B[d])==null?void 0:m.text)==null?void 0:i.split(/,|，/),[b,A,...D]=E,v=/\.(png|jpg|jpeg)$/.test(b);e.push({imgUrl:v?b:"",backColor:v?"":b,detailSheetName:A,content:D,content_e:I,leftInd:Number(d),rightInd:Number(d)+1+(p.merge?p.merge[1]:0),topInd:k,bottomInd:k+1+(p.merge?p.merge[0]:0),width:1+(p.merge?p.merge[1]:0),height:1+(p.merge?p.merge[0]:0)})}}return console.log(y),y},F={class:"wrapper"},j="../../public/",G=M({__name:"home",setup(c){const s=C(!0),r=C("dark");let u=C([]);N(async()=>{console.log("home"),u.value=await q(),h("dark")});function l(){r.value=r.value==="dark"?"light":r.value==="light"?"gray":"dark",h(r.value)}function h(m){window.document.documentElement.setAttribute("data-theme",m)}function y(m){return new URL(m,import.meta.url).href}return(m,i)=>(o(),n("div",F,[(o(!0),n(x,null,T(S(u),t=>(o(),n("div",{class:"row",style:_({height:`${t.height||80}px`,gridTemplateRows:`repeat(${t.rowCount},1fr)`})},[(o(!0),n(x,null,T(t.content,e=>(o(),n("div",{class:"cell",style:_({gridRow:`${e.topInd} / ${e.bottomInd}`,gridColumn:`${e.leftInd} / ${e.rightInd}`,backgroundColor:`#ddd${Math.floor(Math.random()*10)}${Math.floor(Math.random()*10)}${Math.floor(Math.random()*10)}`})},[e.imgUrl&&j?(o(),n("div",{key:0,class:"mask",style:_({"background-image":"url("+y(j+e.imgUrl)+")"})},null,4)):e.backColor?(o(),n("div",{key:1,class:"mask",style:_({backgroundColor:e.backColor})},null,4)):O("",!0),s.value?(o(!0),n(x,{key:2},T(e.content,(a,g)=>(o(),n("span",{key:g,class:$([`text${g}`])},f(a),3))),128)):(o(!0),n(x,{key:3},T(e.content_e,(a,g)=>(o(),n("span",{key:g,class:$([`text${g}`])},f(a),3))),128))],4))),256))],4))),256)),w("div",{class:"btn",onClick:i[0]||(i[0]=t=>s.value=!s.value)},f(s.value?"\u4E2D\u6587":"\u82F1\u6587"),1),w("div",{class:"btn2",onClick:l},f(r.value),1)]))}});const V=(c,s)=>{const r=c.__vccOpts||c;for(const[u,l]of s)r[u]=l;return r},L=V(G,[["__scopeId","data-v-cb99dba8"]]);export{L as default};
