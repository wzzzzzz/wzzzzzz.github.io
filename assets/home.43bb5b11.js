import{d as M,r as k,o as N,a as n,c as o,F as x,b as T,u as S,e as b,t as f,n as _,f as R,g as $}from"./index.4233a846.js";import{_ as U}from"./_plugin-vue_export-helper.cdc0426e.js";const q=[{name:"Sheet1",rows:{0:{cells:{0:{text:"row",style:{patternType:"none"}},1:{text:"column1",style:{patternType:"none"}},2:{text:"column2",style:{patternType:"none"}},3:{text:"column3",style:{patternType:"none"}},4:{text:"column4",style:{patternType:"none"}}}},1:{cells:{0:{text:"100",style:{patternType:"none"}},1:{text:"1.png\uFF0CSheet-1,\u4E2D\u6587\u6587\u672C\uFF0C1234567890",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}},merge:[0,1]},3:{text:"2.png\uFF0Csheet-2,\u7B2C\u4E00\u884C\u7B2C\u4E09\u5217",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}}},4:{text:"3.jpg\uFF0C,,\u53F3\u4E0A\u89D2\uFF0C\u5DE6\u4E0B\u89D2",style:{patternType:"solid",fgColor:{theme:0,tint:-.1499984740745262},bgColor:{indexed:64}}}}},2:{cells:{0:{text:"200",style:{patternType:"none"},merge:[1,0]},1:{text:"4.jpg,,\u7EFF\u8272,\u6D4B\u8BD5,\u6D4B\u8BD52,\u6D4B\u8BD534",style:{patternType:"none"}},2:{text:"5.jpg,\u5168\u662F\u6C49\u5B57,333,\u4E2D\u6587\u6D4B\u8BD5",style:{patternType:"none"}},3:{text:"a.jpg,,\u6CA1\u6709\u82F1\u8BED,,,\u54C8\u54C8\u54C82345",style:{patternType:"none"},merge:[1,1]}}},3:{cells:{1:{text:"b1.jpg,sheet3,444",style:{patternType:"none"},merge:[0,1]}}},4:{cells:{0:{text:"300",style:{patternType:"none"},merge:[2,0]},1:{text:"pink,,,,\u54C8\u54C8\u54C8666,\u4E2D\u6587",style:{patternType:"none"},merge:[2,2]},4:{text:"6.jpg,,,,,\u518D\u6765\u4E00\u4E2A\u6D4B\u8BD5000,\u4E2D\u6587",style:{patternType:"none"}}}},5:{cells:{4:{text:"#ffff11,,#ffff11,\u563F\u563F\u563F\u{1F604}",style:{patternType:"none"},merge:[1,0]}}},6:{cells:{}}},merges:["E6:E7","B4:C4","A3:A4","D3:E4","B2:C2","A5:A7","B5:D7"]},{name:"Sheet-1",rows:{0:{cells:{0:{text:"t",style:{patternType:"none"}}}}},merges:[]},{name:"sheet-2",rows:{0:{cells:{0:{text:"22",style:{patternType:"none"}}}}},merges:[]}],O=[{name:"Sheet1",rows:{0:{cells:{0:{text:"row",style:{patternType:"none"}},1:{text:"column1",style:{patternType:"none"}},2:{text:"column2",style:{patternType:"none"}},3:{text:"column3",style:{patternType:"none"}},4:{text:"column4",style:{patternType:"none"}}}},1:{cells:{0:{text:"1",style:{patternType:"none"}},1:{text:"english1,qqqq",style:{patternType:"none"},merge:[0,1]},3:{text:"hhhhh",style:{patternType:"none"}},4:{text:",rightTop,leftBottom",style:{patternType:"none"}}}},2:{cells:{0:{text:"2",style:{patternType:"none"},merge:[1,0]},1:{text:"green,test12,test23,test34",style:{patternType:"none"}},2:{text:"GGG,333,nochinese",style:{patternType:"none"}},3:{text:"pink,,,hhhhhhh2345",style:{patternType:"none"},merge:[1,1]}}},3:{cells:{1:{text:"444",style:{patternType:"none"},merge:[0,1]}}},4:{cells:{0:{text:"3",style:{patternType:"none"},merge:[2,0]},1:{text:",,test666,QWER",style:{patternType:"none"},merge:[2,2]},4:{text:",,,test000,position",style:{patternType:"none"}}}},5:{cells:{4:{text:"#ffff11,face\u{1F604}",style:{patternType:"none"},merge:[1,0]}}},6:{cells:{}}},merges:["E6:E7","B4:C4","A3:A4","D3:E4","B2:C2","A5:A7","B5:D7"]},{name:"Sheet-1",rows:{0:{cells:{0:{text:"t",style:{patternType:"none"}}}}},merges:[]},{name:"sheet-2",rows:{0:{cells:{0:{text:"22",style:{patternType:"none"}}}}},merges:[]}],F=async()=>{var y,g;let u=q,l=O;const a=u==null?void 0:u[0].rows,i=l==null?void 0:l[0].rows,p=Object.values(a),h=Object.values(i);console.log(p);let c=[];for(let t=1;t<p.length;t++){let e=[],s;p[t].cells[0]?(e=[],c.push({height:Number(p[t].cells[0].text),rowCount:1,content:e})):(s=c[c.length-1],s.rowCount++,e=s.content);const m=p[t].cells,B=h[t].cells;for(const[d,r]of Object.entries(m)){if(d==="0")continue;const w=s?s.rowCount:1,E=r.text.split(/,|，/),I=(g=(y=B[d])==null?void 0:y.text)==null?void 0:g.split(/,|，/),[C,A,...D]=E,v=/\.(png|jpg|jpeg)$/.test(C);e.push({imgUrl:v?C:"",backColor:v?"":C,detailSheetName:A,content:D,content_e:I,leftInd:Number(d),rightInd:Number(d)+1+(r.merge?r.merge[1]:0),topInd:w,bottomInd:w+1+(r.merge?r.merge[0]:0),width:1+(r.merge?r.merge[1]:0),height:1+(r.merge?r.merge[0]:0)})}}return console.log(c),c},G={class:"wrapper"},j="../../public/",V=M({__name:"home",setup(u){const l=k(!0),a=k("dark");let i=k([]);N(async()=>{i.value=await F(),h("dark")});function p(){a.value=a.value==="dark"?"light":a.value==="light"?"gray":"dark",h(a.value)}function h(y){window.document.documentElement.setAttribute("data-theme",y)}function c(y){return new URL(y,import.meta.url).href}return(y,g)=>(n(),o("div",G,[(n(!0),o(x,null,T(S(i),t=>(n(),o("div",{class:"row",style:_({height:`${t.height||80}px`,gridTemplateRows:`repeat(${t.rowCount},1fr)`})},[(n(!0),o(x,null,T(t.content,e=>(n(),o("div",{class:"cell",style:_({gridRow:`${e.topInd} / ${e.bottomInd}`,gridColumn:`${e.leftInd} / ${e.rightInd}`,backgroundColor:`#ddd${Math.floor(Math.random()*10)}${Math.floor(Math.random()*10)}${Math.floor(Math.random()*10)}`})},[e.imgUrl&&j?(n(),o("div",{key:0,class:"mask",style:_({"background-image":"url("+c(j+e.imgUrl)+")"})},null,4)):e.backColor?(n(),o("div",{key:1,class:"mask",style:_({backgroundColor:e.backColor})},null,4)):R("",!0),l.value?(n(!0),o(x,{key:2},T(e.content,(s,m)=>(n(),o("span",{key:m,class:$([`text${m}`])},f(s),3))),128)):(n(!0),o(x,{key:3},T(e.content_e,(s,m)=>(n(),o("span",{key:m,class:$([`text${m}`])},f(s),3))),128))],4))),256))],4))),256)),b("div",{class:"btn",onClick:g[0]||(g[0]=t=>l.value=!l.value)},f(l.value?"\u4E2D\u6587":"\u82F1\u6587"),1),b("div",{class:"btn2",onClick:p},f(a.value),1)]))}});const P=U(V,[["__scopeId","data-v-9130372c"]]);export{P as default};
